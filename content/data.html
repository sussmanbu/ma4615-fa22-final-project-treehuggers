---
title: Data
description:
toc: true
featuredVideo:
featuredImage: images/tree.jpeg
draft: false
---


<div id="TOC">

</div>

<p>Our first dataset, the NaNDA Parks data “Parks by Census Tract, United States, 2018,” came from the following source: <a href="https://www.openicpsr.org/openicpsr/project/117921/version/V1/view" class="uri">https://www.openicpsr.org/openicpsr/project/117921/version/V1/view</a>.
In order to open the dataset, you must create a free account. After this, both the dataset and an accompanying dictionary describing the variables (NaNDA_Parks_by_Census_Tract_2018_v1-1.pdf) can be downloaded.</p>
<p>This data was collected by Phillippa Clarke, Robert Melendez, and Megan Chenoweth from the University of Michigan’s Institute for Social Research. The research was funded by the US Department of Health and Human Services, National Institutes of Health, National Institute on Aging; and the Department of Health and Human Services, Administration for Community Living, National Institute on Disability, Independent Living, and Rehabilitation Research.</p>
<p>This dataset was created by the Trust for Public Land to aid researchers in learning about how access to public parks may contribute to physical and mental health. Since access to parks and greenspace has been shown to positively impact physical activity levels, health while aging, and people’s sense of well-being, this data provides researchers with concrete information about park access within each US census tract so they can further examine the impact of greenspace on health.</p>
<p>This dataset has 11 columns and about 73,000 rows, which represent the census tracts in the US, excluding island territories but including Alaska and Hawai’i. The data is from 2018, but was collected in 2020. It describes the number and area of parks for each census tract.</p>
<p>The major variables that we considered were “count_open_parks”, which gave the total number of open parks in the census tract, “tract_area_sqmiles”, which described the total area of the census tract in square miles, and “tot_park_area_sqmiles”, which described the total area of parks within the census tract in square miles. These two variables enabled the calculation of “prop_park_area_tract”, which was the proportion of open park land within the total area of the census tract. We also used “tract_fips10”, the code for the census tract, during our data cleaning in order to isolate specific areas of the US and organize the data by county instead of census tract. This data cleaning process is further described below.</p>
<p>Other variables in the dataset included count_open_parks_tc10, count_open_parks_tc5, count_open_parks_tc3, and any_open_parks. These were used by the researchers to control for a few census tracts that contained very high numbers of parks, and therefore were top-coded at 10, 5, 3, and 1 (ie, any value greater than n was replaced by the phrase “n or more” in the dataset). Although we explored these variables, they did not end up being extremely relevant to our final analyses. The dataset also included “tract_area” and “tot_park_area”, which described the areas of the census tracts and park lands in square meters, rather than square miles.</p>
<p>Our second dataset, Asthma Hospitalization Rates by County (for California), can be found at the following link: <a href="https://catalog.data.gov/dataset/asthma-hospitalization-rates-by-county-16dab" class="uri">https://catalog.data.gov/dataset/asthma-hospitalization-rates-by-county-16dab</a>. This data is publicly accessible and can be freely downloaded, along with the data dictionary.</p>
<p>This data was collected and published by the California Department of Public Health, along with California Breathing, Environmental Health Investigations Branch. This dataset covers the period from 2015 to 2019 and contains various statistics and demographics related to hospitalizations for asthma.</p>
<p>Publicly funded hospitals publish annual surveys of some important demographic and health information on a generalized level. This information is collected by the state and distributed to the public; however, in accordance with proper deidentification practices, some of this data has been suppressed if the number of hospitalizations in a certain county is so low that someone could identify the individual person based on the dataset information.</p>
<p>This dataset contains “county” and “year” variables to identify the geographic location and time period when the data was collected. There is also an “Age group” variable, which contains the following brackets: all ages, 0-4, 0-17, 5-17, 18-64-, 18+, and 65+. The variable “number of hospitalizations” give the number of hospitalizations for asthma in a named county for a named year - per hospitalization, not per person (as in, one person can count for multiple hospitalizations). The variable “age-adjusted hospitalization visit rate” is a numeric that roughly describes the proportion of hospitalizations for a specific county and age group’s population. The “comment” variable states whether data has been suppressed in a specific line of the dataset and why (generally for de-identification purposes). Finally, the “strata” and “strata name” categories contain general and specific demographic levels by which the data has been stratified. This included categories like age group, child vs. adult, and race/ethnicity for the “strata”, and the individual levels/categories were described with “strata name”. We worked a lot with these variables during data cleaning, as described below.</p>
<p>During data cleaning, we decided that since we would ultimately be combining the two datasets, we would focus on data from California and 2018 from both of the datasets in order to have a single set of data with the same parameters.</p>
<p>Therefore, we started by filtering the Parks datasets for only California-based census tracts. To do this, we filtered by the census tract codes that started with “06” - California’s number. We then created a small data dictionary that connected each California county with its census tract numbers and then added “county name” as an additional variable in the dataset. We also did some cleanup of variable names to make them more standardized and clearer for our own use.</p>
<p>Our code is shown below, along with descriptions of what each segment does:</p>
<p>tract_ca &lt;- nanda_parks_tract_2018_01P %&gt;% filter(grepl(‘^06’, tract_fips10), any_open_park == 1) filters data so that it’s only the CA counties and also only included counties that had at least 1 open park</p>
<p>clean1_tract &lt;- tract_ca %&gt;% select(tract_fips10, count_open_parks, tract_area_sqmiles, tot_park_area_sqmiles, prop_park_area_tract) selects relevant columns (tracts, # open parks per tract, sq miles of tract, total sq miles of parks in tract, proportion of park to tract area)</p>
<p>colnames(clean1_tract) &lt;- c(“tractcode”, “open_parks_tract”, “tract_area_sqmiles”, “total_open_park_area_sqmiles”, “prop_open_park_land_within_tract”) renames columns so it’s more clear what they are</p>
<p>CA_countytract2 &lt;- CA_countytract %&gt;% mutate(tractcode = str_sub(<code>TYPE; FULLCODE; STATE; COUNTY; TRACT; SHEETS</code>, 7, 17)) selects for just column with codes and then creates new column that isolates the full code</p>
<p>joined_CA_countytract &lt;- clean1_tract %&gt;% inner_join(CA_countytract2, by = “tractcode”) joins the CA_countytract2 table with the clean1_tract table by tractcode, keeping all of the rows where the tractcode from clean1_tract is a match for tractcode in CA_countytract2</p>
<p>clean2_tract &lt;- joined_CA_countytract %&gt;% select(-<code>TYPE; FULLCODE; STATE; COUNTY; TRACT; SHEETS</code>, -…3, -…4, -…5, -…6) gets rid of extraneous columns; only leaves county names</p>
<p>clean2_tract &lt;- clean2_tract[, c(1, 6, 2, 3, 4, 5)] reorders columns to put county name next to code</p>
<p>colnames(clean2_tract) &lt;- c(“tractcode”, “county_name”, “open_parks_tract”, “tract_area_sqmiles”, “total_open_park_area_sqmiles”, “prop_open_park_land_within_tract”) quick rename of county name column to be less aggressively uppercase</p>
<hr />
<p>All Information To Be Cut Before Final
## Where to keep data?</p>
<p>Below 50mb: In <code>dataset</code> folder</p>
<p>Above 50mb: In <code>dataset_ignore</code> folder. This folder will be ignored by <code>git</code> so you’ll have to manually sync these files across your team.</p>
<div id="sharing-your-data" class="section level3">
<h3>Sharing your data</h3>
<p>For small datasets (&lt;50mb), you can use the <code>dataset</code> folder that is tracked by github. Add the files just like you would any other file.</p>
<p><strong>Do not</strong> use a folder named <code>data</code>.
This folder is reserved by <code>hugo</code>.
If you create a folder named <code>data</code> this will cause problems.</p>
<p>For larger datasets, you’ll need to create a new folder in the project root directory named <code>dataset-ignore</code>. This will be ignored by git (based off the <code>.gitignore</code> file in the project root directory) which will help you avoid issues with Github’s size limits. Your team will have to manually make sure the data files in <code>dataset-ignore</code> are synced across team members.</p>
<p>Your <a href="/load_and_clean_data.R">load_and_clean_data.R</a> file is how you will load and clean your data. Here is a an example of a very simple one.</p>
<pre class="r"><code>source(
  here::here(&quot;static&quot;, &quot;load_and_clean_data.R&quot;),
  echo = TRUE # Use echo=FALSE or omit it to avoid code output  
)</code></pre>
<pre><code>## 
## &gt; library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ ggplot2 3.3.6      ✔ purrr   0.3.4 
## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
## ✔ tidyr   1.2.1      ✔ stringr 1.4.1 
## ✔ readr   2.1.2      ✔ forcats 0.5.2 
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre><code>## 
## &gt; loan_data &lt;- read_csv(here::here(&quot;dataset&quot;, &quot;loan_refusal.csv&quot;))</code></pre>
<pre><code>## Rows: 20 Columns: 5
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (1): bank
## dbl (4): min, white, himin, hiwhite
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre><code>## 
## &gt; loan_data_clean &lt;- loan_data
## 
## &gt; write_csv(loan_data_clean, file = here::here(&quot;dataset&quot;, 
## +     &quot;loan_refusal_clean.csv&quot;))
## 
## &gt; save(loan_data_clean, file = here::here(&quot;dataset/loan_refusal.RData&quot;))</code></pre>
<p>Note how I use the <code>here::here</code> function from the <a href="https://here.r-lib.org/articles/here.html"><code>here</code> package</a> to avoid path problems.
This function is used to specify directories within the project’s root directory.
You should never use absolute paths (eg. <code>/Users/danielsussman/path/to/project/</code> or <code>C:\\MA415\\Final_Project\\</code>) and using <code>here</code> ensures that it doesn’t matter what the current working directory is as long as you have this RStudio Project open.</p>
<hr />
</div>
<div id="files-in-static" class="section level2">
<h2>Files in static</h2>
<div id="load_and_clean_data.r" class="section level3">
<h3><code>load_and_clean_data.R</code></h3>
<p>The idea behind this file is that someone coming to your website could largely replicate your analyses after running this script on the original data sets to clean them.
This file might create a derivative data set that you then use for your subsequent analysis.
Note that you don’t need to run this script from every post/page.
Instead, you can load in the results of this script, which could be plain text files or <code>.RData</code> files. In your data page you’ll describe how these results were created. If you have a very large data set, you might save smaller data sets that you can use for exploration purposes.
To link to this file, you can use <code>[cleaning script](/load_and_clean_data.R)</code>.</p>
<p>When you are loading in data, I recommend using the <code>here::here</code> function to specify the file path. This function is used to specify a path relative to your project’s root directory. Hence, you can read a file using eg, <code>read_csv(here::here("dataset/data_file.csv"))</code>.</p>
</div>
<div id="shiny-interactive" class="section level3">
<h3>Shiny Interactive</h3>
<p>If you are using a shiny interactive, you’ll need to keep that in a separate folder (i.e. not in <code>static</code> or <code>content</code>). For the shiny interactive you’ll need to publish the app on <code>shinyapps.io</code> where the app can be run. When you publish, make sure to include any data sets you are loading in among the files you publish since those datasets will need to be loaded by your app.</p>
<hr />
</div>
</div>
<div id="rubric-on-this-page" class="section level2">
<h2>Rubric: On this page</h2>
<p>you will</p>
<ul>
<li>Describe where/how to find data.
<ul>
<li>You must include a link to the original data source(s). Make sure to provide attribution to those who collected the data.</li>
<li>Why was the data collected/curated? Who put it together? (This is important, if you don’t know why it was collected then that might not be a good dataset to look at.</li>
</ul></li>
<li>Describe the different data files used and what each variable means.
<ul>
<li>If you have many variables then only describe the most relevant ones and summarize the rest.</li>
</ul></li>
<li>Describe any cleaning you had to do for your data.
<ul>
<li>You <em>must</em> include a link to your <code>load_and_clean_data.R</code> file.</li>
<li>Also, describe any additional R packages you used outside of those covered in class.</li>
<li>Describe and show code for how you combined multiple data files and any cleaning that was necessary for that.</li>
<li>Some repetition of what you do in your <code>load_and_clean_data.R</code> file is fine and encouraged if it helps explain what you did.</li>
</ul></li>
<li>Organization, clarity, cleanliness of the page
<ul>
<li>Make sure to remove excessive warnings, use clean easy-to-read code (without side scrolling), organize with sections, use bullets and other organization tools, etc.</li>
</ul></li>
</ul>
</div>
