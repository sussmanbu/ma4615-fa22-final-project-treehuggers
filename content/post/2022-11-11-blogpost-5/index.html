---
title: "Blogpost #5 - Combining Datasets"
author: Treehuggers
date: '2022-11-11'
slug: []
categories: []
tags: []
description: We discuss the progress we have made in combining our datasets so far, as well as our observations as a result of combining them.
toc: yes
authors: []
series: []
lastmod: '2022-11-11T17:48:46-05:00'
featuredVideo: ~
featuredImage: ~
---

<script src="{{< blogdown/postref >}}index_files/htmlwidgets/htmlwidgets.js"></script>
<script src="{{< blogdown/postref >}}index_files/plotly-binding/plotly.js"></script>
<script src="{{< blogdown/postref >}}index_files/typedarray/typedarray.min.js"></script>
<script src="{{< blogdown/postref >}}index_files/jquery/jquery.min.js"></script>
<link href="{{< blogdown/postref >}}index_files/crosstalk/css/crosstalk.min.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index_files/crosstalk/js/crosstalk.min.js"></script>
<link href="{{< blogdown/postref >}}index_files/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index_files/plotly-main/plotly-latest.min.js"></script>

<div id="TOC">

</div>

<p>For our project, we are combining two datasets: one on asthma hospitalization rates per county in California and one on the number of parks per census tract in California. We also had to make a temporary dataset to organize which census tracts belonged to which counties since the names were not included in the parks dataset, and we combined the temporary dataset with the parks dataset. The asthma dataset contains asthma hospitalization rates along with demographic information such as age group and race, and the parks dataset contains the amount of land used for parks and the total amount of land in each census tract, as well as the proportion of land used for public parks.</p>
<p>We used inner_join() by tractcode to join our original parks dataset with the temporary dataset with the county names associated with each tract. The code we used to accomplish this can be seen in our previous blog post, Blog Post 4.</p>
<p>We are still doing some cleaning of the asthma dataset but have performed an initial cleaning and combined what we have so far with our cleaned parks dataset using inner_join() by county_name. This is the progress we have made:</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ ggplot2 3.3.6      ✔ purrr   0.3.4 
## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
## ✔ tidyr   1.2.0      ✔ stringr 1.4.1 
## ✔ readr   2.1.2      ✔ forcats 0.5.2 
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>load(here::here(&quot;dataset&quot;, &quot;clean_parks_data.RData&quot;))

asthmaCA_race_ethnicity &lt;- read_rds(&quot;~/Desktop/ma415/ma4615-fa22-final-project-treehuggers/dataset/asthmaCA_race_ethnicity.RData&quot;)

asthmaCA_race_ethnicity &lt;- asthmaCA_race_ethnicity %&gt;% filter(YEAR == &quot;2018&quot;)

colnames(asthmaCA_race_ethnicity) &lt;- c(&quot;county_name&quot;, &quot;year&quot;, &quot;strata&quot;, &quot;race_ethnicity&quot;, &quot;age_group&quot;, &quot;number_hospitalizations&quot;, &quot;age_adjusted_hospitalization_rate&quot;)

asthmaCA_race_ethnicity &lt;- asthmaCA_race_ethnicity %&gt;% mutate(county_name = str_to_upper(county_name))

parks_asthmaCA_race_ethnicity &lt;- clean_parks_data %&gt;% inner_join(asthmaCA_race_ethnicity, by = &quot;county_name&quot;)</code></pre>
<p>Our initial findings are that we have some outliers that we originally suspected were very large counties, specifically Los Angeles. In our previous post, we had a lot of overlapping labels on the x-axis. After cleaning up and adjusting the graphs and plots that we have made so far by adding theme(), we can see that the labels have become much clearer. We can see that the outliers in the asthma datasets are both Los Angeles, which makes sense given what we previously noted about the county’s much denser population. Based on this plot, we can see that Los Angeles has the highest amount of hospitalizations by far compared to the other counties. Also, by using ggplotly, we can make an interactive graph as well, which makes observing the data more straightforward. The interactive graph shows exactly which county and how many hospitalizations for each.</p>
<pre class="r"><code>library(plotly)</code></pre>
<pre><code>## 
## Attaching package: &#39;plotly&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     last_plot</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     layout</code></pre>
<pre class="r"><code>asthma_fig &lt;- parks_asthmaCA_race_ethnicity %&gt;% filter(county_name != &quot;CALIFORNIA&quot;, strata == &quot;Total population&quot;, !is.na(number_hospitalizations)) %&gt;% ggplot(aes(x = county_name, y = number_hospitalizations)) + geom_jitter() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + labs(x = &quot;County Name&quot;, y = &quot;Number of Hospitalizations&quot;, title = &quot;Total Number of Asthma Hospitalizations for California Counties in 2018&quot;) 

ggplotly(asthma_fig)</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"data":[{"visible":false,"showlegend":false,"xaxis":null,"yaxis":null,"hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":28.4931506849315,"l":25.5707762557078},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Total Number of Asthma Hospitalizations for California Counties in 2018","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.05,1.05],"tickmode":"array","ticktext":[],"tickvals":[],"categoryorder":"array","categoryarray":[],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"County Name","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.05,1.05],"tickmode":"array","ticktext":[],"tickvals":[],"categoryorder":"array","categoryarray":[],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Number of Hospitalizations","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"793816bba893":{"x":{},"y":{},"type":"scatter"}},"cur_data":"793816bba893","visdat":{"793816bba893":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>The biggest issue in combining data so far has not been the actual combining part but cleaning the data prior to combining it. It was, and still is, difficult to clean the asthma dataset because of how the columns are arranged, and the parks dataset also provided some issues when we had to determine which tracts belong to which counties. However, the actual combining has been going well. We just need to finalize how much and what kind of information we want from the asthma dataset, particularly in regards to age and race.</p>
<p>Other than this, we are pretty much finished combining the datasets. Our next steps are continuing to clean the data and performing further analysis now that it is combined. We will identify any other outliers and examine trends between our many variables through further plotting.</p>
